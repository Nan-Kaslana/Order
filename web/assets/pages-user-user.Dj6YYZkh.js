import{r as a,Q as e,v as t,f as s,A as o,s as l,a as c,c as i,w as n,i as r,o as u,b as d,d as f,G as m,R as g,g as p,S as _,n as v,T as h,h as y,U as x,V as b}from"./index-B3ir4qvj.js";import{r as F,_ as I}from"./uni-app.es.B7CJl36A.js";import{u as w,_ as A}from"./FooterNav.CvHX5To4.js";import"sass";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const z=k({__name:"user",setup(k){const z=w(),E=a("");a("http://darkskl.site:9495"),E.value=e("token");const P=a(""),S=a(""),L=a("");t(async()=>{try{const a=await s(o.USER_GETINFO);L.value=a.data.data.userInfo.ID,S.value=a.data.data.userInfo.nickName,P.value=o.BASE+"/"+a.data.data.userInfo.headerImg,console.log(P.value),0!=a.data.code&&l({title:a.data.msg,icon:"none"})}catch(a){l({title:"网络错误请重试",icon:"error"})}});const O=a([{text:"首页",url:"/pages/home/home"},{text:"客服",url:"/pages/service/service"},{text:"记录",url:"/pages/record/record"},{text:"个人",url:"/pages/user/user"}]);function R(){z.toggleLang()}function T(a){return z.convertText(a)}async function C(){try{const a=await x({count:1,sizeType:["original","compressed"],sourceType:["album","camera"]});if(!a||!a.tempFilePaths||0===a.tempFilePaths.length)return void console.log("未选择图片");const e=a.tempFilePaths[0],t=await b(o.FILE_UPLOAD,e);console.log("上传成功",t),console.log(t.data.data.file.url),P.value=o.BASE+"/"+t.data.data.file.url;!async function(a){const e=await s(o.USER_MODIFY_SELF_PROFILE,{headerImg:a});console.log(e.data)}(t.data.data.file.url)}catch(a){console.log("操作失败",a)}}function D(){C()}async function N(){g({title:T("修改用户名"),editable:!0,placeholderText:T("请输入新用户名"),success:async a=>{if(a.confirm&&a.content){S.value=a.content;try{const e=await s(o.USER_MODIFY_SELF_PROFILE,{nickName:a.content});console.log(e.data),l({title:T("用户名已更新"),icon:"success"})}catch(e){l({title:"更新失败",icon:"none"}),console.error(e)}}}})}function U(){g({title:T("确认退出"),content:T("确定要退出当前账号吗？"),success:a=>{a.confirm&&(p("token",""),_({url:"/pages/index/index"}))}})}function j(){v({url:"/pages/changePass/changePass"})}return(a,e)=>{const t=r,s=h,o=y,l=F(c("uni-icons"),I),g=F(c("FooterNav"),A);return u(),i(t,{class:"home-page"},{default:n(()=>[d(t,{class:"bg-decoration"},{default:n(()=>[d(t,{class:"bg-blob blob-1"}),d(t,{class:"bg-blob blob-2"})]),_:1}),d(t,{class:"user-info-card"},{default:n(()=>[d(t,{class:"avatar-section"},{default:n(()=>[d(t,{class:"avatar-container"},{default:n(()=>[d(s,{class:"avatar",src:P.value,mode:"widthFix"},null,8,["src"])]),_:1}),d(t,{class:"user-basic"},{default:n(()=>[d(o,{class:"user-name"},{default:n(()=>[f(m(T(S.value)),1)]),_:1}),d(o,{class:"user-id"},{default:n(()=>[f(m(T("ID:"))+" "+m(L.value),1)]),_:1})]),_:1})]),_:1}),d(t,{class:"function-list"},{default:n(()=>[d(t,{class:"function-item",onClick:D},{default:n(()=>[d(l,{type:"image",size:"20",color:"#4A35A8",class:"item-icon"}),d(o,{class:"item-text"},{default:n(()=>[f(m(T("修改头像")),1)]),_:1}),d(l,{type:"right",size:"18",color:"#999",class:"item-arrow"})]),_:1}),d(t,{class:"function-item",onClick:N},{default:n(()=>[d(l,{type:"edit",size:"20",color:"#4A35A8",class:"item-icon"}),d(o,{class:"item-text"},{default:n(()=>[f(m(T("修改用户名")),1)]),_:1}),d(l,{type:"right",size:"18",color:"#999",class:"item-arrow"})]),_:1}),d(t,{class:"function-item",onClick:j},{default:n(()=>[d(l,{type:"edit",size:"20",color:"#4A35A8",class:"item-icon"}),d(o,{class:"item-text"},{default:n(()=>[f(m(T("修改密码")),1)]),_:1}),d(l,{type:"right",size:"18",color:"#999",class:"item-arrow"})]),_:1}),d(t,{class:"function-item",onClick:R},{default:n(()=>[d(l,{type:"translate",size:"20",color:"#4A35A8",class:"item-icon"}),d(o,{class:"item-text"},{default:n(()=>[f(m(T("繁体/简体切换")),1)]),_:1}),d(l,{type:"right",size:"18",color:"#999",class:"item-arrow"})]),_:1}),d(t,{class:"function-item logout-item",onClick:U},{default:n(()=>[d(l,{type:"logout",size:"20",color:"#F53F3F",class:"item-icon"}),d(o,{class:"item-text logout-text"},{default:n(()=>[f(m(T("退出登录")),1)]),_:1}),d(l,{type:"right",size:"18",color:"#999",class:"item-arrow"})]),_:1})]),_:1})]),_:1}),d(g,{navs:O.value},null,8,["navs"])]),_:1})}}},[["__scopeId","data-v-a6061bf2"]]);export{z as default};
