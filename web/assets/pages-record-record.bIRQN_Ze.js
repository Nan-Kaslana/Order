import{r as t,K as e,t as n,s,q as r,a,c as u,w as i,i as o,o as c,b as l,d,F as f,G as h,H as m,J as $,A as p,L as y,M as v,N as _,O as g,E as M,g as D,P as w,h as b,C as S}from"./index-D6i_hTCv.js";import{_ as k,r as O,a as x}from"./uni-app.es.Chso5W8v.js";import{u as C,_ as Y}from"./FooterNav.CcZmmZcX.js";import{a as T,A as H}from"./utils.CPUApmy1.js";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function L(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var j={exports:{}};const N=L(j.exports=function(){var t=1e3,e=6e4,n=36e5,s="millisecond",r="second",a="minute",u="hour",i="day",o="week",c="month",l="quarter",d="year",f="date",h="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,$=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},y=function(t,e,n){var s=String(t);return!s||s.length>=e?t:""+Array(e+1-s.length).join(n)+t},v={s:y,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),s=Math.floor(n/60),r=n%60;return(e<=0?"+":"-")+y(s,2,"0")+":"+y(r,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var s=12*(n.year()-e.year())+(n.month()-e.month()),r=e.clone().add(s,c),a=n-r<0,u=e.clone().add(s+(a?-1:1),c);return+(-(s+(n-r)/(a?r-u:u-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:d,w:o,d:i,D:f,h:u,m:a,s:r,ms:s,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},_="en",g={};g[_]=p;var M="$isDayjsObject",D=function(t){return t instanceof k||!(!t||!t[M])},w=function t(e,n,s){var r;if(!e)return _;if("string"==typeof e){var a=e.toLowerCase();g[a]&&(r=a),n&&(g[a]=n,r=a);var u=e.split("-");if(!r&&u.length>1)return t(u[0])}else{var i=e.name;g[i]=e,r=i}return!s&&r&&(_=r),r||!s&&_},b=function(t,e){if(D(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new k(n)},S=v;S.l=w,S.i=D,S.w=function(t,e){return b(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var k=function(){function p(t){this.$L=w(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[M]=!0}var y=p.prototype;return y.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(S.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var s=e.match(m);if(s){var r=s[2]-1||0,a=(s[7]||"0").substring(0,3);return n?new Date(Date.UTC(s[1],r,s[3]||1,s[4]||0,s[5]||0,s[6]||0,a)):new Date(s[1],r,s[3]||1,s[4]||0,s[5]||0,s[6]||0,a)}}return new Date(e)}(t),this.init()},y.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},y.$utils=function(){return S},y.isValid=function(){return!(this.$d.toString()===h)},y.isSame=function(t,e){var n=b(t);return this.startOf(e)<=n&&n<=this.endOf(e)},y.isAfter=function(t,e){return b(t)<this.startOf(e)},y.isBefore=function(t,e){return this.endOf(e)<b(t)},y.$g=function(t,e,n){return S.u(t)?this[e]:this.set(n,t)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(t,e){var n=this,s=!!S.u(e)||e,l=S.p(t),h=function(t,e){var r=S.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return s?r:r.endOf(i)},m=function(t,e){return S.w(n.toDate()[t].apply(n.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},$=this.$W,p=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(l){case d:return s?h(1,0):h(31,11);case c:return s?h(1,p):h(0,p+1);case o:var _=this.$locale().weekStart||0,g=($<_?$+7:$)-_;return h(s?y-g:y+(6-g),p);case i:case f:return m(v+"Hours",0);case u:return m(v+"Minutes",1);case a:return m(v+"Seconds",2);case r:return m(v+"Milliseconds",3);default:return this.clone()}},y.endOf=function(t){return this.startOf(t,!1)},y.$set=function(t,e){var n,o=S.p(t),l="set"+(this.$u?"UTC":""),h=(n={},n[i]=l+"Date",n[f]=l+"Date",n[c]=l+"Month",n[d]=l+"FullYear",n[u]=l+"Hours",n[a]=l+"Minutes",n[r]=l+"Seconds",n[s]=l+"Milliseconds",n)[o],m=o===i?this.$D+(e-this.$W):e;if(o===c||o===d){var $=this.clone().set(f,1);$.$d[h](m),$.init(),this.$d=$.set(f,Math.min(this.$D,$.daysInMonth())).$d}else h&&this.$d[h](m);return this.init(),this},y.set=function(t,e){return this.clone().$set(t,e)},y.get=function(t){return this[S.p(t)]()},y.add=function(s,l){var f,h=this;s=Number(s);var m=S.p(l),$=function(t){var e=b(h);return S.w(e.date(e.date()+Math.round(t*s)),h)};if(m===c)return this.set(c,this.$M+s);if(m===d)return this.set(d,this.$y+s);if(m===i)return $(1);if(m===o)return $(7);var p=(f={},f[a]=e,f[u]=n,f[r]=t,f)[m]||1,y=this.$d.getTime()+s*p;return S.w(y,this)},y.subtract=function(t,e){return this.add(-1*t,e)},y.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var s=t||"YYYY-MM-DDTHH:mm:ssZ",r=S.z(this),a=this.$H,u=this.$m,i=this.$M,o=n.weekdays,c=n.months,l=n.meridiem,d=function(t,n,r,a){return t&&(t[n]||t(e,s))||r[n].slice(0,a)},f=function(t){return S.s(a%12||12,t,"0")},m=l||function(t,e,n){var s=t<12?"AM":"PM";return n?s.toLowerCase():s};return s.replace($,function(t,s){return s||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return S.s(e.$y,4,"0");case"M":return i+1;case"MM":return S.s(i+1,2,"0");case"MMM":return d(n.monthsShort,i,c,3);case"MMMM":return d(c,i);case"D":return e.$D;case"DD":return S.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return d(n.weekdaysMin,e.$W,o,2);case"ddd":return d(n.weekdaysShort,e.$W,o,3);case"dddd":return o[e.$W];case"H":return String(a);case"HH":return S.s(a,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return m(a,u,!0);case"A":return m(a,u,!1);case"m":return String(u);case"mm":return S.s(u,2,"0");case"s":return String(e.$s);case"ss":return S.s(e.$s,2,"0");case"SSS":return S.s(e.$ms,3,"0");case"Z":return r}return null}(t)||r.replace(":","")})},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(s,f,h){var m,$=this,p=S.p(f),y=b(s),v=(y.utcOffset()-this.utcOffset())*e,_=this-y,g=function(){return S.m($,y)};switch(p){case d:m=g()/12;break;case c:m=g();break;case l:m=g()/3;break;case o:m=(_-v)/6048e5;break;case i:m=(_-v)/864e5;break;case u:m=_/n;break;case a:m=_/e;break;case r:m=_/t;break;default:m=_}return h?m:S.a(m)},y.daysInMonth=function(){return this.endOf(c).$D},y.$locale=function(){return g[this.$L]},y.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),s=w(t,e,!0);return s&&(n.$L=s),n},y.clone=function(){return S.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},p}(),O=k.prototype;return b.prototype=O,[["$ms",s],["$s",r],["$m",a],["$H",u],["$W",i],["$M",c],["$y",d],["$D",f]].forEach(function(t){O[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),b.extend=function(t,e){return t.$i||(t(e,k,b),t.$i=!0),b},b.locale=w,b.isDayjs=D,b.unix=function(t){return b(1e3*t)},b.en=g[_],b.Ls=g,b.p={},b}()),A=k({__name:"record",setup(k){const L=C();function j(t){return L.convertText(t)}const A=t(["全部","待支付","已冻结","已完成"]),F=t(0),I=t([]),W=t([{text:"首页",url:"/pages/home/home"},{text:"客服",url:"/pages/service/service"},{text:"记录",url:"/pages/record/record"},{text:"个人",url:"/pages/user/user"}]),q=t(!1),P=e({});function U(){q.value=!1}const E=t(""),V=t("");async function J(){try{g({url:`http://darkskl.site:9494/commodityOrder/submitOrderEvaluation?\n\t\t\tevaluation=${E.value}&orderId=${V.value}`,method:"GET",header:{"x-token":M("token")},success:t=>{console.log(t.data),s({title:"提交成功",icon:"success"})}})}catch(t){console.error(t)}}n(async()=>{try{const t=(await T(H.USER_BYSELFLD)).data.data.orders;I.value=t.map(t=>{const e=N(t.CreatedAt).format("YYYY-MM-DD HH:mm:ss"),n=t.Commodity;return V.value=t.ID,n?{time:e,status:t.status,name:n.commodifyName,price:n.serllingPrice,quantity:t.quantity,commission:(Number(n.serllingPrice)*t.quantity*Number(n.commissionRate)).toFixed(2)}:null}).filter(t=>t)}catch(t){s({title:j("网络异常，请重试"),icon:"none"})}});const z=r(()=>{if(0===F.value)return I.value;const t={1:"waitPayment",2:"cancel",3:"completed"};return I.value.filter(e=>e.status===t[F.value])});return(t,e)=>{const n=o,s=O(a("uni-icons"),x),r=D,g=w,M=b,k=O(a("FooterNav"),Y);return c(),u(n,{class:"record-page"},{default:i(()=>[l(n,{class:"custom-header"},{default:i(()=>[l(n,{class:"header-content"},{default:i(()=>[d(f(j("订单记录")),1)]),_:1})]),_:1}),l(n,{class:"tab-bar"},{default:i(()=>[(c(!0),h($,null,m(A.value,(t,e)=>(c(),u(n,{key:e,onClick:t=>F.value=e,class:S(["tab-item",{active:F.value===e}])},{default:i(()=>[d(f(j(t)),1)]),_:2},1032,["onClick","class"]))),128))]),_:1}),l(n,{class:"order-list"},{default:i(()=>[0===z.value.length?(c(),u(n,{key:0,class:"empty-state"},{default:i(()=>[l(s,{type:"folder-open",size:"60",class:"empty-icon"}),l(r,null,{default:i(()=>[d(f(j("暂无订单记录")),1)]),_:1})]),_:1})):p("",!0),(c(!0),h($,null,m(z.value,(t,e)=>(c(),u(n,{key:e,class:"order-item",onClick:e=>function(t){Object.assign(P,t),q.value=!0}(t)},{default:i(()=>[l(n,{class:"order-header"},{default:i(()=>[l(n,{class:"order-time"},{default:i(()=>[d(f(t.time),1)]),_:2},1024),l(n,{class:S(["status-tag",`status-${t.status}`])},{default:i(()=>["completed"===t.status?(c(),u(r,{key:0},{default:i(()=>[d(f(j("已完成")),1)]),_:1})):"default"===t.status?(c(),u(r,{key:1},{default:i(()=>[d(f(j("全部")),1)]),_:1})):"waitPayment"===t.status?(c(),u(r,{key:2},{default:i(()=>[d(f(j("待支付")),1)]),_:1})):"cancel"===t.status?(c(),u(r,{key:3},{default:i(()=>[d(f(j("已冻结")),1)]),_:1})):(c(),u(r,{key:4},{default:i(()=>[d(f(j("未知")),1)]),_:1}))]),_:2},1032,["class"])]),_:2},1024),l(n,{class:"order-content"},{default:i(()=>[l(n,{class:"order-name"},{default:i(()=>[d(f(t.name),1)]),_:2},1024),l(n,{class:"order-details"},{default:i(()=>[l(r,null,{default:i(()=>[d(f(j("RMB"))+"："+f(t.price),1)]),_:2},1024),l(r,null,{default:i(()=>[d(f(j("数量"))+"："+f(t.quantity),1)]),_:2},1024)]),_:2},1024),l(n,{class:"commission"},{default:i(()=>[d(f(j("佣金"))+"："+f(j("RMB"))+" "+f(t.commission),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}),y(l(n,{class:"popup-overlay",onClick:_(U,["self"])},{default:i(()=>[l(n,{class:"popup-content"},{default:i(()=>[l(n,{class:"close-btn",onClick:U},{default:i(()=>[d("×")]),_:1}),l(n,{class:"popup-title"},{default:i(()=>[d(f(P.name),1)]),_:1}),l(n,{class:"popup-info"},{default:i(()=>[l(r,null,{default:i(()=>[d("价格："+f(P.price),1)]),_:1}),l(r,null,{default:i(()=>[d("数量："+f(P.quantity),1)]),_:1}),l(r,null,{default:i(()=>[d("佣金："+f(P.commission),1)]),_:1}),l(r,null,{default:i(()=>[d("时间："+f(P.time),1)]),_:1})]),_:1}),l(g,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=t=>E.value=t),class:"rating-input",placeholder:"请输入您的评价"},null,8,["modelValue"]),l(M,{class:"submit-btn",onClick:J},{default:i(()=>[d("提交")]),_:1})]),_:1})]),_:1},512),[[v,q.value]]),l(k,{navs:W.value},null,8,["navs"])]),_:1})}}},[["__scopeId","data-v-3be0c771"]]);export{A as default};
