import{l as t,m as e,r as n,p as a,u as i,q as r,t as s,v as o,x as l,y as u,z as c,o as d,c as h,w as f,b as p,B as m,C as v,D as y,E as g,i as b,h as _,F as w,f as k,A as x,s as S,a as C,d as A,G as F,j as $}from"./index-B3ir4qvj.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as M}from"./uni-app.es.B7CJl36A.js";import{u as T,_ as D}from"./FooterNav.CvHX5To4.js";const z={canvasId:{type:String,default:null},percent:{type:Number,default:0},size:{type:String,default:"120px"},lineCap:{type:String,default:"round"},strokeWidth:{type:[String,Number],default:6},strokeColor:{type:[String,Array],default:"#2db7f5"},trailWidth:{type:[String,Number],default:6},trailColor:{type:String,default:"#ddd"},dashboard:Boolean,clockwise:{type:Boolean,default:!0},duration:{type:Number,default:300},max:{type:Number,default:100},gapDegree:{type:Number,default:90},gapPosition:{type:String,default:"bottom"},canvas:Boolean};function R(e,n,a=!1){return null==n?Promise.reject("context is null"):(n.context&&(n=n.context),new Promise((i,r)=>{const s=t().in(n).select(e),o=t=>{t?i(t):r("no rect")};a?s.fields({node:!0,size:!0,rect:!0},o).exec():s.boundingClientRect(o).exec()}))}let j=!1;function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;e.length>n;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function G(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function N(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,r=[],s=!0,o=!1;try{for(n=n.call(t);!(s=(a=n.next()).done)&&(r.push(a.value),!e||r.length!==e);s=!0);}catch(l){o=!0,i=l}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return r}}(t,e)||O(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){if(t){if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(t,e):void 0}}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);e>n;n++)a[n]=t[n];return a}var W=function(t){return/^#.{3,6}$/.test(t)?4===t.length?t.substring(1).split("").map(function(t){return 17*parseInt(t,16)}):[t.substring(1,3),t.substring(3,5),t.substring(5,7)].map(function(t){return parseInt(t,16)}):(console.error("lime-circle: 渐变仅支持hex值"),[0,0,0])},q=function(t){return 1===t.length?"0"+t:t},B=function(t,e,n){var a,i,r,s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=[],u=[],c=function(t){return Math.pow(t/255,o)};for(t=W(t).map(c),e=W(e).map(c),a=0;n>a;a++){for(s=1-(r=a/(n-1)),i=0;3>i;i++)u[i]=q(Math.round(255*Math.pow(t[i]*s+e[i]*r,1/o)).toString(16));l.push("#"+u.join(""))}return l},U=function(){var t=1e-6,e=1-2.7,n=3*.1;function a(t){return((1*t-.75)*t+.75)*t}return function(i){return r=function(e){for(var n,i,r,s=e,o=0;8>o;o++){if(i=a(s)-e,t>Math.abs(i))return s;if(t>Math.abs(n=(3*(r=s)-1.5)*r+.75))break;s-=i/n}var l=1,u=0;for(s=e;l>u;){if(i=a(s)-e,t>Math.abs(i))return s;i>0?l=s:u=s,s=(l+u)/2}return s}(i),((e*r+2.4)*r+n)*r;var r}}(),L=Symbol("tick"),Y=Symbol("tick-handler"),H=Symbol("animations"),J=Symbol("start-times"),K=Symbol("pause-start"),Q=Symbol("pause-time"),X="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){return setTimeout(t,1e3/60)},Z="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(t){clearTimeout(t)},tt=function(){function t(){P(this,t),this.state=void 0,this.state="Initiated",this[H]=new Set,this[J]=new Map}return G(t,[{key:"start",value:function(){var t=this;if("Initiated"===this.state){this.state="Started";var e=Date.now();this[Q]=0,this[L]=function(){var n,a=Date.now(),i=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=O(t))){e&&(t=e);var n=0,a=function(){};return{s:a,n:function(){return t.length>n?{done:!1,value:t[n++]}:{done:!0}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return r=t.done,t},e:function(t){s=!0,i=t},f:function(){try{r||null==e.return||e.return()}finally{if(s)throw i}}}}(t[H]);try{for(i.s();!(n=i.n()).done;){var r=n.value,s=void 0;(s=t[J].get(r)<e?a-e-r.delay-t[Q]:a-t[J].get(r)-r.delay-t[Q])>r.duration&&(t[H].delete(r),s=r.duration),s>0&&r.run(s)}}catch(o){i.e(o)}finally{i.f()}t[Y]=X(t[L])},this[L]()}}},{key:"pause",value:function(){"Started"===this.state&&(this.state="Paused",this[K]=Date.now(),Z(this[Y]))}},{key:"resume",value:function(){"Paused"===this.state&&(this.state="Started",this[Q]+=Date.now()-this[K],this[L]())}},{key:"reset",value:function(){this.pause(),this.state="Initiated",this[Q]=0,this[K]=0,this[H]=new Set,this[J]=new Map,this[Y]=null}},{key:"add",value:function(t,e){2>arguments.length&&(e=Date.now()),this[H].add(t),this[J].set(t,e)}}]),t}(),et=function(){function t(e,n,a,i,r,s){P(this,t),this.startValue=void 0,this.endValue=void 0,this.duration=void 0,this.timingFunction=void 0,this.delay=void 0,this.template=void 0,r=r||function(t){return t},s=s||function(t){return t},this.startValue=e,this.endValue=n,this.duration=a,this.timingFunction=r,this.delay=i,this.template=s}return G(t,[{key:"run",value:function(t){var e=this.endValue-this.startValue,n=this.timingFunction(t/this.duration);this.template(this.startValue+e*n)}}]),t}(),nt=Math.PI/180,at=function(){function t(e,n){P(this,t),this.canvas=void 0,this.context=void 0,this.current=0,this.size=0,this.pixelRatio=1,this._isConicGradient=!1,this._attrs={percent:0,size:120,lineCap:"round",strokeWidth:6,strokeColor:"#2db7f5",trailWidth:6,trailColor:"#ddd",dashboard:!1,clockwise:!0,duration:300,max:100,beforeAnimate:!0,animate:!0,formatter:"{d}{d}.{d}{d}%",fontSize:"16px",showText:!1,gapDegree:90,gapPosition:"bottom"},this._timer=void 0,this.startTime=0,this.target=0,this._colors=[],this._gradientColors=[],this._rAF=function(t){},this._cAf=function(t){},this.timeline=void 0,this.run=void 0,this.canvas=e,this.run=n.run,this.size=n.size||120,this.pixelRatio=n.pixelRatio||1,this.init(),this.initRaf(),this.timeline=new tt}return G(t,[{key:"init",value:function(){var t=this.size,e=this.pixelRatio;if(this.canvas){this.canvas.width=t*e,this.canvas.height=t*e;var n=this.canvas.getContext("2d");this._isConicGradient=!!n.createConicGradient,this.context=n}}},{key:"initRaf",value:function(){var t=this.canvas;"undefined"!=typeof window?(this._rAF=window.requestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},this._cAf=window.cancelAnimationFrame||function(t){window.clearTimeout(t)}):t&&t.requestAnimationFrame?(this._rAF=t.requestAnimationFrame,this._cAf=t.cancelAnimationFrame):(this._rAF=function(t){return setTimeout(t,16.7)},this._cAf=function(t){clearTimeout(t)})}},{key:"setOption",value:function(t){Object.assign(this._attrs,t)}},{key:"set",value:function(t,e){this._attrs[t]=e}},{key:"get",value:function(t){return this._attrs[t]||this.canvas[t]}},{key:"play",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.get("percent");this.target=Math.max(Math.min(e,this.get("max")||100),0),this.createConicGradient(),this.timeline.start(),this.timeline.add(new et(this.current,e,this.get("duration"),0,U,function(e){t.current=1e-4>e?0:e,t.render(t.current),t.run(t.current)}))}},{key:"createConicGradient",value:function(){if(!this._isConicGradient){var t=this._attrs.strokeColor;if("string"!=typeof t&&this._colors!=t&&Array.isArray(t)){var e=N(this.getDeg(),2),n=e[0],a=e[1];this._colors=t,this._gradientColors=[];for(var i=a-n,r=t.length-1,s=Math.floor(i/r),o=0;r>o;o++)i-=s,this._gradientColors=this._gradientColors.concat(B(t[o],t[o+1],o+1===r?s+i:s,1))}}}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.context,n=this.size,a=this.pixelRatio,i=this.getSalce(),r=n/2;e.setTransform(1,0,0,1,0,0),e.clearRect(2*-r,2*-r,4*n,4*n),e.setTransform(i*a,0,0,a,r*a,r*a),this.drawTrail(r),this.drawStroke(r,t),e.draw&&e.draw()}},{key:"drawArc",value:function(t,e,n,a,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this._attrs.lineCap,s=this.context;s.beginPath(),s.lineCap=r,s.strokeStyle=e,s.lineWidth=n,s.arc(0,0,t,a,i),s.stroke()}},{key:"getSalce",value:function(){return this.get("clockwise")?1:-1}},{key:"getDeg",value:function(){var t=this._attrs,e=t.gapDegree;t.dashboard||(e=0);var n=(0===e?0:{bottom:0,top:180,left:90,right:-90}[t.gapPosition])+(e>0?90+e/2:-90)+0;return[n,n+(360-e)/360*360]}},{key:"drawTrail",value:function(t){var e=this._attrs,n=e.trailWidth,a=e.trailColor,i=t-n/2,r=N(this.getDeg(),2);this.drawArc(i,a,n,r[0]*nt,r[1]*nt)}},{key:"drawStroke",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e){var n=this._attrs,a=n.strokeWidth,i=n.strokeColor,r=n.max,s=n.dashboard,o=n.lineCap,l=N(this.getDeg(),2),u=l[0],c=l[1],d=t-a/2,h=Math.round((c-u)/r*e);if("string"==typeof i||this._isConicGradient)if(Array.isArray(i)&&this._isConicGradient){var f=this.context.createConicGradient(u,0,0);i.forEach(function(t,e){f.addColorStop(e/(i.length-1),t)}),this.drawArc(d,f,a,u*nt,(h+u)*nt)}else this.drawArc(d,i,a,u*nt,(h+u)*nt);else for(var p=0;h>p;p++)this.drawArc(d,this._gradientColors[p],a,(p+u)*nt,(p+1+u)*nt,s||c!=h+u?o:"butt")}}}]),t}();let it=function(t,e,n,a){const i=1e-6,r=3*t-3*n+1,s=3*n-6*t,o=3*t,l=3*e-3*a+1,u=3*a-6*e,c=3*e;function d(t){return(3*r*t+2*s)*t+o}function h(t){return((r*t+s)*t+o)*t}return function(t){return e=function(t){let e,n,a=t;for(let o=0;o<8;o++){if(n=h(a)-t,Math.abs(n)<i)return a;if(e=d(a),Math.abs(e)<i)break;a-=n/e}let r=1,s=0;for(a=t;r>s;){if(n=h(a)-t,Math.abs(n)<i)return a;n>0?r=a:s=a,a=(r+s)/2}return a}(t),((l*e+u)*e+c)*e;var e}}(.25,.1,.25,1);const rt=Symbol("tick"),st=Symbol("tick-handler"),ot=Symbol("animations"),lt=Symbol("start-times"),ut=Symbol("pause-start"),ct=Symbol("pause-time"),dt="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){return setTimeout(t,1e3/60)},ht="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(t){clearTimeout(t)};class ft{constructor(){this.state="Initiated",this[ot]=new Set,this[lt]=new Map}start(){if("Initiated"!==this.state)return;this.state="Started";let t=Date.now();this[ct]=0,this[rt]=()=>{let e=Date.now();this[ot].forEach(n=>{let a;a=this[lt].get(n)<t?e-t-n.delay-this[ct]:e-this[lt].get(n)-n.delay-this[ct],a>n.duration&&(this[ot].delete(n),a=n.duration),a>0&&n.run(a)}),this[st]=dt(this[rt])},this[rt]()}pause(){"Started"===this.state&&(this.state="Paused",this[ut]=Date.now(),ht(this[st]))}resume(){"Paused"===this.state&&(this.state="Started",this[ct]+=Date.now()-this[ut],this[rt]())}reset(){this.pause(),this.state="Initiated",this[ct]=0,this[ut]=0,this[ot]=new Set,this[lt]=new Map,this[st]=null}add(t,e){arguments.length<2&&(e=Date.now()),this[ot].add(t),this[lt].set(t,e)}}class pt{constructor(t,e,n,a,i,r){i=i||(t=>t),r=r||(t=>t),this.startValue=t,this.endValue=e,this.duration=n,this.timingFunction=i,this.delay=a,this.template=r}run(t){let e=this.endValue-this.startValue,n=t/this.duration;1!=n&&(n=this.timingFunction(n)),this.template(this.startValue+e*n)}}function mt(t){return/^(-)?\d+(\.\d+)?$/.test(t)}function vt(t){return function(t){return null!=t}(t)?mt(t=String(t))?`${t}px`:t:null}function yt(t){return"string"==typeof t}function gt(t,e=0){if(mt(t))return Number(t);if(yt(t)){const n=/^-?([0-9]+)?([.]{1}[0-9]+){0,1}(em|rpx|px|%)$/g.exec(t);if(!t||!n)return 0;const a=n[3],r=parseFloat(t);if("rpx"===a)return i(r);if("px"===a)return 1*r;if("%"==a)return r/100*e}return 0}function bt(t,e,n,a,i,r,s){const o=0===a?0:{bottom:0,top:180,left:90,right:-90}[i],l=a>0?90+a/2:-90,u=function(t,e){const n=gt(t),a=gt(e);return{s:n,w:a,c:(n-a)/2,r:n/2-a}}(e,s),c=(360-a)/360*n*100,d=o+l+90,h=function(t=0){return`radial-gradient(transparent ${t-.5}px, #000 ${t}px)`}(u.r);let f="",p="",m="";if(yt(r))p=r,m=r,f=`conic-gradient(from ${d}deg, ${p} 0%, ${p} ${c}%, transparent ${c}%, transparent 100%)`;else if(Array.isArray(r)){f=`conic-gradient(from ${d}deg, transparent 0%,`;const t=r.length;for(let e=0;e<t;e++){const n=r[e];0===e?(f+=`${n} 0%,`,p=n):f+=`${n} ${c*(e+1)/t}%,`,e==t-1&&(m=n)}f+=`transparent ${c}%, transparent 100%)`}return{color:p,[`--l-circle-${t}-cap-start`]:`${d}deg`,[`--l-circle-${t}-cap-color-end`]:m,[`--l-circle-${t}-cap-end`]:`${c/100*360+d}deg`,[`--l-circle-${t}-cap-size`]:s/2+"px",mask:h,"-webkit-mask":h,"--l-background":f}}const _t=I(r({name:"l-circle",props:z,emits:["update:current"],setup(t,{emit:i}){const r=u(),d=n(t.canvas),h=Math.random().toString(16).slice(2),f=`l-circle-${t.canvasId||r.uid+h}`;let p=null;const m=n(0),v=n(0),y=function(t,e){const i=n(0),{immediate:r,duration:s=300}=e;let o=null,l=-1;return a("function"==typeof t?t:()=>t.value,t=>{null==o&&(o=new ft),o.start(),o.add(new pt(i.value,t,s,0,it,e=>{i.value=e,clearTimeout(l),i.value==t&&(l=setTimeout(()=>{null==o||o.pause(),o=null},s))}))},{immediate:r}),i}(m,{duration:t.duration}),g=s(()=>({width:vt(t.size),height:vt(t.size),"--l-circle-offset-top":!d.value&&v.value})),b=s(()=>{const{clockwise:e,lineCap:n}=t;return n?`is-${n} `:" "+!e&&!d.value&&"clockwise"}),_=s(()=>[gt(t.trailWidth),gt(t.strokeWidth)]),w=s(()=>{const{size:e,trailColor:n,dashboard:a,gapDegree:i,gapPosition:r}=t;return bt("trail",e,1,a?i:0,r,n,_.value[0])}),k=s(()=>{const{size:e,strokeColor:n,dashboard:a,max:i,gapDegree:r,gapPosition:s}=t;return bt("stroke",e,Math.min(y.value/t.max,1),a?r:0,s,n,_.value[1])}),x=a(()=>t.percent,e=>{m.value=Math.min(e,t.max),p&&p.play(e)}),S=a(y,t=>{i("update:current",t.toFixed(2))});return o(()=>{R(".check",r.proxy).then(n=>{d.value=!(n.height>0&&!t.canvas),d.value&&setTimeout(()=>{(async function(t,n){let{context:a}=n;return R("#"+t,a,j).then(({node:n})=>{if(n)return n;{j=!1;const n=e(t,a);return{getContext(t){if("2d"==t)return n}}}})})(f,{context:r.proxy}).then(e=>{p=new at(e,{size:gt(t.size),run:t=>y.value=t,pixelRatio:j?c().pixelRatio:1}),p.setOption(Object.assign({},t,{trailWidth:_.value[0],strokeWidth:_.value[1]})),p.play(t.percent)})},50),m.value=t.percent})}),l(()=>{x(),S()}),{useCanvas:d,innerCanvasId:f,classes:b,styles:g,trailStyles:w,strokeStyles:k,current:y}}}),[["render",function(t,e,n,a,i,r){const s=b,o=_,l=w;return d(),h(s,{class:g(["l-circle",[{clockwise:!t.clockwise&&!t.useCanvas},["is-"+t.lineCap]]]),style:m([t.styles])},{default:f(()=>[p(s,{class:"check"}),t.useCanvas?v("",!0):(d(),h(s,{key:0,class:"l-circle__trail",style:m([t.trailStyles])},{default:f(()=>[p(o,{class:"cap start"}),p(o,{class:"cap end"})]),_:1},8,["style"])),t.useCanvas?v("",!0):(d(),h(s,{key:1,class:"l-circle__stroke",style:m([t.strokeStyles])},{default:f(()=>[p(s,{class:"l-circle__stroke-line"}),t.current?(d(),h(o,{key:0,class:"cap start"})):v("",!0),t.current?(d(),h(o,{key:1,class:"cap end"})):v("",!0)]),_:1},8,["style"])),t.useCanvas?(d(),h(l,{key:2,type:"2d","canvas-id":t.innerCanvasId,id:t.innerCanvasId,class:"l-circle__canvas"},null,8,["canvas-id","id"])):v("",!0),p(s,{class:"l-circle__inner"},{default:f(()=>[y(t.$slots,"default",{},void 0,!0)]),_:3})]),_:3},8,["class","style"])}],["__scopeId","data-v-c82ed766"]]),wt=I({__name:"home",setup(t){const e=T();function a(t){return e.convertText(t)}const i=n(""),r=n(""),s=n(""),l=n(""),u=n(1),c=n(""),m=n("");async function v(){try{const t=await k(x.GRABORDER);0==t.data.data.code?S({title:a("抢单成功")}):S({title:a(t.data.msg)})}catch(t){console.error("抢单请求失败：",t),S({title:a("网络异常，请重试"),icon:"none"})}}o(async()=>{try{const t=await k(x.USER_GETINFO);c.value=t.data.data.userInfo.nickName}catch(t){console.error("昵称请求失败：",t)}try{const t=await k(x.GET_USER_STORE_INFO_BY_SELF_ID);r.value=t.data.data.saving,i.value=t.data.data.revenues,m.value=t.data.data.maxOrderCapacity,l.value=t.data.data.commodityCount,s.value=function(t){const e=m.value;return Math.min(t/e*100,100)}(l.value)}catch(t){S({title:res.data.msg,icon:"error"})}});const y=n([{text:"首页",url:"/pages/home/home"},{text:"客服",url:"/pages/service/service"},{text:"记录",url:"/pages/record/record"},{text:"个人",url:"/pages/user/user"}]);return(t,e)=>{const n=b,o=_,g=M(C("l-circle"),_t),w=$,k=M(C("FooterNav"),D);return d(),h(n,{class:"home-page"},{default:f(()=>[p(n,{class:"bg-decoration"},{default:f(()=>[p(n,{class:"bg-blob blob-1"}),p(n,{class:"bg-blob blob-2"})]),_:1}),p(n,{class:"user-info-card"},{default:f(()=>[p(n,{class:"info-header"},{default:f(()=>[p(g,{current:u.value,"onUpdate:current":e[0]||(e[0]=t=>u.value=t),percent:Number(s.value)},{default:f(()=>[p(o,null,{default:f(()=>[A(F(l.value)+"/"+F(m.value),1)]),_:1})]),_:1},8,["current","percent"]),p(n,{class:"info-details"},{default:f(()=>[p(o,{class:"greeting",style:{"font-size":"40rpx"}},{default:f(()=>[A(F(a("您好"))+"，"+F(c.value),1)]),_:1}),p(o,{class:"balance",style:{"font-size":"30rpx"}},{default:f(()=>[A(F(a("总余额：RMB"))+" "+F(r.value),1)]),_:1}),p(o,{class:"income",style:{"font-size":"30rpx"}},{default:f(()=>[A(F(a("收益：RMB"))+" "+F(i.value),1)]),_:1})]),_:1})]),_:1}),p(n,{class:"info-footer"},{default:f(()=>[p(o,{class:"operate-time"},{default:f(()=>[A(F(a("平台运营时间每日10:00至22:00。如需帮助，请联络平台客服。")),1)]),_:1}),p(w,{class:"start-btn",onClick:v},{default:f(()=>[A(F(a("开始抢单")),1)]),_:1})]),_:1})]),_:1}),p(k,{navs:y.value},null,8,["navs"])]),_:1})}}},[["__scopeId","data-v-8a1d1957"]]);export{wt as default};
